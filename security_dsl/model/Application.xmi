<?xml version="1.0" encoding="UTF-8"?>
<security_dsl:Application
    xmi:version="2.0"
    xmlns:xmi="http://www.omg.org/XMI"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:security_dsl="http://www.example.org/security_dsl"
    xsi:schemaLocation="http://www.example.org/security_dsl security_dsl.ecore"
    name="demo"
    packageName="rs.ac.uns.ftn.demo">
  <app_database
      url="url"
      username="username"
      password="password"/>
  <app_models
      xsi:type="security_dsl:Role"
      tableName="roles">
    <model_attributes
        name="id"
        type="Long"
        isIdentifier="true"
        collumnName="id"/>
    <model_attributes
        name="name"
        collumnName="name"/>
    <role_instances
        name="admin"/>
    <role_instances
        name="user"/>
  </app_models>
  <app_models
      xsi:type="security_dsl:User"
      tableName="users">
    <model_attributes
        name="id"
        type="Long"
        isIdentifier="true"
        collumnName="id"/>
    <model_attributes
        name="username"
        collumnName="username"/>
    <model_attributes
        name="firstName"
        collumnName="first_name"/>
    <model_attributes
        name="lastName"/>
    <model_attributes
        name="email"
        collumnName="email"/>
  </app_models>
  <app_controllers
      xsi:type="security_dsl:Authentication"
      name="auth"
      path="/auth">
    <controller_endpoints
        url="/registration"
        functionName="registration"
        method="POST"
        type="REGISTRATION"/>
    <controller_endpoints
        url="/login"
        functionName="login"
        type="LOGIN"/>
    <controller_endpoints
        url="/logout"
        functionName="logout"
        role_authorities="//@app_models.0/@role_instances.0 //@app_models.0/@role_instances.1"/>
  </app_controllers>
  <app_security
      xsi:type="security_dsl:JWT"
      signatureAlgorithm="HS512">
    <jwt_claims
        type="REGISTERED"
        claim_attribute="//@app_models.1/@model_attributes.1"
        name="subject"/>
    <jwt_claims
        claim_attribute="//@app_models.1/@model_attributes.4"
        name="email"/>
    <registeredclaims
        expirationTime="36000"
        issuer="demo"/>
  </app_security>
</security_dsl:Application>
